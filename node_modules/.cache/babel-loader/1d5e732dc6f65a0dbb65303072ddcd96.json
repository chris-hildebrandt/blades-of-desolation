{"ast":null,"code":"import { reactive } from \"@vue/reactivity\";\nimport $store from \"@/store/index.js\";\nimport { spellsService } from \"@/services/SpellsService\";\nimport Notify from \"@/utils/Notify\";\nimport { useToast } from \"vue-toastification\";\nexport default {\n  name: 'MagicShop',\n  props: {\n    spellList: {\n      type: Object\n    }\n  },\n\n  setup() {\n    const state = reactive({});\n    return state;\n  },\n\n  methods: {\n    async buySpell(spell) {\n      const toast = useToast();\n      let price = spell.price ?? spell.level * 1000 + 1000;\n\n      if ($store.state.player.gold < price) {\n        toast.warning('Insufficient resources');\n        return;\n      }\n\n      let description = spell.description ?? `Deals ${spell.strength} ${spell.dmgType} DMG to ${spell.areaEffect ? 'each ' : ''}enemy`;\n      let char = await Notify.selectChar(spell.name, price, description);\n\n      if (char == 0 || !char) {\n        return;\n      }\n\n      let character = $store.state.player.characters.filter(c => c.id == char)[0];\n      this.$store.commit('reducePlayerGold', price);\n      spellsService.learnSpell(spell.name, character);\n    },\n\n    getTitle(spell) {\n      let title = '';\n\n      if (spell.strength) {\n        title = spell.strength + ' ' + spell.dmgType + ' dmg';\n      } else {\n        title = spell.buff ? '+' : '-';\n        title += spell.value + ' ' + spell.effect;\n      }\n\n      title += spell.areaEffect ? ' (Mass effect)' : '';\n      return title;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAiBA,SAASA,QAAT,QAAyB,iBAAzB;AACA,OAAOC,MAAP,MAAmB,kBAAnB;AACA,SAASC,aAAT,QAA8B,0BAA9B;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AACA,SAASC,QAAT,QAAyB,oBAAzB;AACA,eAAe;AACfC,MAAI,EAAE,WADS;AAEfC,OAAK,EAAE;AACHC,aAAS,EAAE;AAACC,UAAI,EAAEC;AAAP;AADR,GAFQ;;AAKfC,OAAK,GAAE;AACL,UAAMC,KAAI,GAAIX,QAAQ,CAAC,EAAD,CAAtB;AAEA,WAAOW,KAAP;AACD,GATc;;AAUfC,SAAO,EAAE;AACP,UAAMC,QAAN,CAAeC,KAAf,EAAqB;AACnB,YAAMC,KAAI,GAAIX,QAAQ,EAAtB;AACA,UAAIY,KAAI,GAAIF,KAAK,CAACE,KAAN,IAAeF,KAAK,CAACG,KAAN,GAAY,IAAZ,GAAiB,IAA5C;;AACA,UAAGhB,MAAM,CAACU,KAAP,CAAaO,MAAb,CAAoBC,IAApB,GAA2BH,KAA9B,EAAoC;AAClCD,aAAK,CAACK,OAAN,CAAc,wBAAd;AACA;AACF;;AACA,UAAIC,WAAU,GAAIP,KAAK,CAACO,WAAN,IAAsB,SAAQP,KAAK,CAACQ,QAAQ,IAAIR,KAAK,CAACS,OAAO,WAAWT,KAAK,CAACU,UAAN,GAAmB,OAAnB,GAA6B,EAAG,OAA1H;AACA,UAAIC,IAAG,GAAI,MAAMtB,MAAM,CAACuB,UAAP,CAAkBZ,KAAK,CAACT,IAAxB,EAA8BW,KAA9B,EAAqCK,WAArC,CAAjB;;AACA,UAAGI,IAAG,IAAK,CAAR,IAAa,CAACA,IAAjB,EAAsB;AACpB;AACF;;AACA,UAAIE,SAAQ,GAAI1B,MAAM,CAACU,KAAP,CAAaO,MAAb,CAAoBU,UAApB,CAA+BC,MAA/B,CAAsCC,KAAKA,CAAC,CAACC,EAAF,IAAQN,IAAnD,EAAyD,CAAzD,CAAhB;AACA,WAAKxB,MAAL,CAAY+B,MAAZ,CAAmB,kBAAnB,EAAuChB,KAAvC;AACAd,mBAAa,CAAC+B,UAAd,CAAyBnB,KAAK,CAACT,IAA/B,EAAqCsB,SAArC;AACD,KAhBM;;AAiBPO,YAAQ,CAACpB,KAAD,EAAO;AACb,UAAIqB,KAAI,GAAI,EAAZ;;AACA,UAAGrB,KAAK,CAACQ,QAAT,EAAkB;AAChBa,aAAI,GAAIrB,KAAK,CAACQ,QAAN,GAAe,GAAf,GAAmBR,KAAK,CAACS,OAAzB,GAAiC,MAAzC;AACD,OAFD,MAEK;AACHY,aAAI,GAAIrB,KAAK,CAACsB,IAAN,GAAa,GAAb,GAAmB,GAA3B;AACAD,aAAI,IAAKrB,KAAK,CAACuB,KAAN,GAAY,GAAZ,GAAgBvB,KAAK,CAACwB,MAA/B;AACF;;AACAH,WAAI,IAAKrB,KAAK,CAACU,UAAN,GAAmB,gBAAnB,GAAuC,EAAhD;AACA,aAAOW,KAAP;AACF;;AA3BO;AAVM,CAAf","names":["reactive","$store","spellsService","Notify","useToast","name","props","spellList","type","Object","setup","state","methods","buySpell","spell","toast","price","level","player","gold","warning","description","strength","dmgType","areaEffect","char","selectChar","character","characters","filter","c","id","commit","learnSpell","getTitle","title","buff","value","effect"],"sourceRoot":"","sources":["C:\\Users\\dhild\\source\\mini-projects\\blades-of-desolation\\src\\components\\MagicShop.vue"],"sourcesContent":["<template>\r\n  <div class=\"row pt-2\">\r\n    <div class=\"col-12\">\r\n      <h1 for=\"buy\">Learn Spells</h1>\r\n    </div>\r\n  </div>\r\n  <div class=\"row mh-100\">\r\n    <div class=\"col-md-6 col-12\">\r\n      <ul v-for=\"spells in spellList\" :key=\"spells\">\r\n        <label for=\"spells\" v-if=\"spells.length > 0\">{{spells[0].level > 0 ? \"Level \"+spells[0].level : 'Cantrip'}} Spells</label>\r\n        <li v-for=\"spell in spells\" :key=\"spell.name\" @click=\"buySpell(spell)\" :title=\"spell.title ?? getTitle(spell)\">{{spell.name}} - {{spell.price ?? spell.level*1000+1000}} <i class=\"fad fa-coins\"></i></li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive } from \"@vue/reactivity\"\r\nimport $store from \"@/store/index.js\"\r\nimport { spellsService } from \"@/services/SpellsService\"\r\nimport Notify from \"@/utils/Notify\"\r\nimport { useToast } from \"vue-toastification\"\r\nexport default {\r\nname: 'MagicShop',\r\nprops: {\r\n    spellList: {type: Object}\r\n},\r\nsetup(){\r\n  const state = reactive({\r\n  })\r\n  return state\r\n},\r\nmethods: {\r\n  async buySpell(spell){\r\n    const toast = useToast()\r\n    let price = spell.price ?? spell.level*1000+1000\r\n    if($store.state.player.gold < price){\r\n      toast.warning('Insufficient resources')\r\n      return\r\n    }\r\n    let description = spell.description ?? `Deals ${spell.strength} ${spell.dmgType} DMG to ${spell.areaEffect ? 'each ' : ''}enemy`\r\n    let char = await Notify.selectChar(spell.name, price, description)\r\n    if(char == 0 || !char){\r\n      return\r\n    }\r\n    let character = $store.state.player.characters.filter(c => c.id == char)[0]\r\n    this.$store.commit('reducePlayerGold', price)\r\n    spellsService.learnSpell(spell.name, character)\r\n  },\r\n  getTitle(spell){\r\n    let title = ''\r\n    if(spell.strength){\r\n      title = spell.strength+' '+spell.dmgType+' dmg'\r\n    }else{\r\n      title = spell.buff ? '+' : '-'\r\n      title += spell.value+' '+spell.effect\r\n    }\r\n    title += spell.areaEffect ? ' (Mass effect)' :  ''\r\n    return title\r\n  }\r\n}\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nli{\r\n  cursor: pointer;\r\n}\r\nlabel{\r\n  right: 9vw;\r\n  position: relative;\r\n  color:#00c700;\r\n  font-size: large;\r\n}\r\n.mh-100{\r\n  height: 75vh;\r\n  overflow-y: auto;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}